#tag ClassProtected Class RatingCellImplements CustomListboxCell	#tag Method, Flags = &h0		Function cellClick(x as integer, y as integer) As boolean		  //calculate the "rating"		  rating=(x+3)\13		  if rating>max then rating=max		  if rating<0 then rating=0		  		  return true		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub cellPaint(g as graphics, row as integer)		  #pragma disableBackgroundTasks		  		  //paint the *		  dim i,sx, olds as integer		  dim oldf as string		  		  g.foreColor=&c888888		  oldf=g.textfont		  olds=g.textsize		  g.textfont="arial"		  g.textsize=24		  sx=13		  		  for i=1 to max		    if i<=rating then		      g.drawstring "*",sx-4,g.height+7		    else		      g.fillOval sx,g.height/2,2,2		    end if		    sx=sx+13		  next		  g.textsize=olds		  g.textfont=oldf		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function compareValue() As integer		  //return the numeric value of the rating		  return rating		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor(rating as integer, max as integer)		  self.rating=rating		  self.max=max		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub owner(assigns value as CustomCellListbox)		  //we don't need this		End Sub	#tag EndMethod	#tag Property, Flags = &h1		Protected max As integer	#tag EndProperty	#tag Property, Flags = &h1		Protected ownerList As CustomCellListbox	#tag EndProperty	#tag Property, Flags = &h1		Protected rating As integer	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass